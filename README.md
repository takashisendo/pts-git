<!-- $theme: gaia -->

# チーム開発を変える<br>Gitの徹底活用法

#### 3/16 Pasona Tech セミナー

###### Sprocket CTO: 中田 稔

---

## Git とは？

---

==分散型バージョン管理システムの決定版！==

- テキストで管理できるものであればなんでも
  - Code、HTML、CSS、README、 etc.
- 差分情報を記録する
  - diff ベース
- 画像等のバイナリデータも扱える
  - あまり得意ではない
  - 差分が取れないため、まるっと保存

---

## diff とは？

---

2つのファイルを比較し、差分を抽出するツール

```diff
--- a/src/app.js
+++ b/src/app.js
@@ -19,7 +19,12 @@ const client = new Wit({

     getForecast: req => {
       console.log('getForecast:', JSON.stringify(req, null, '  '));
-      req.context.forecast = 'sunny';
+      if (!req.entities.location) {
+        req.context.missingLocation = true;
+      } else {
+        req.context.forecast = 'sunny';
+        req.context.location = req.entities.location[0].value;
+      }
       return Promise.resolve(req.context);
     }
   }
```

---

## バージョン管理の歴史1

- RCS
  - ファイル単体、ローカルでの差分管理
  - サーバ上の設定ファイルの履歴管理で今でも使ったりする

---

## バージョン管理の歴史2

- CVS
  - 中央管理サーバの登場
  - RCS を複数ファイルに対応したイメージ
    - ただし個別のファイルの集合体なので、それぞれのファイルにバージョンが付く

---

## バージョン管理の歴史3

- SVN
  - 複数ファイルの修正を纏めて履歴管理、バージョン番号をつけられるようになった
  - バージョン番号が連番で付与される

---

## バージョン管理の歴史4

- Git
  - 中央管理サーバの排除・分散化
    - 独立した複数のリポジトリが協調して作用
    - リモート、分散開発に有利
  - ローカルも1つの独立したリポジトリ
    - ネットがなくても使える！

---

## ローカルとリモート

分散管理なので、少々概念がややこしい
![](images/fetch_pull_push.png)

---

## チーム開発における<br>Git活用のポイント

---

## Git活用のポイント1

ブランチを多用する

- 何か作業をするときは基本的にブランチを作る
  - 違う機能やバグ修正は別ブランチ
  - ブランチ毎に==作業の独立性==を保つ
    - 他人の修正の影響を極力避ける
- 修正が終わったらプルリクエスト
  - マージされたらブランチ削除
  - ==作業場感覚==で作っては捨てる

---

## Git活用のポイント2

目的が明確なコミットを作る

- 1つの機能追加・バグ修正を==1つのコミット==にする
  - 中途半端・不完全なコミットを作らない
  - 「作業途中」「fix typo」 とかはダメ
  - レビューする人が苦痛
- 大きな機能追加の場合はサブ機能毎にコミットを作ることはある
  - 大量の修正をレビューするのは大変
  - コミット単位でレビューできるように

---

## Git活用のポイント3

コミットログだけで==修正内容がわかる==ようにする

- レビューしたり後から調査する際に重要
  - コードの中身を毎回見ていられない
  - 「バグ修正」「機能追加」のようなものはダメ
  - 「○○の□□を××した」のように明確にする
- ポイント2ができていれば自ずと明確になるはず

---

## Git活用のポイントまとめ

1. ブランチを多用する
2. 目的が明確なコミットを作る
3. コミットログだけで修正内容がわかるようにする

初めからそんなキレイなコミットは作れない...
⇒ 後から整理すればOK
⇒ ==履歴の書き換えが必須==

Gitは履歴を書き換えてなんぼの世界！

---

## 使い勝手を向上させる設定

---

## alias の作成

`git log` はそのままでは使いにくいので、graph 表示が可能なように alias を作成する

```bash
% git config --local alias.graph \
  "log --graph --oneline --decorate=short"
```

これで `git graph` が使えるようになる
※ 実際はもっと良い設定あり

```bash
% git graph

* fe78873 (HEAD -> master, origin/master) initial commit
```

※ 今回は `--local` ですが、`--global` が便利

---

他にも、SVN ユーザであれば

```bach
ci => commit
co => checkout
```

等の設定をしておくと便利。

`git ci`、`git co` のように利用できる。
